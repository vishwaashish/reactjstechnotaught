{"ast":null,"code":"import _createForOfIteratorHelper from\"C:/Users/vishw/OneDrive/Desktop/reactjs nodejs/client/Client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _regeneratorRuntime from\"C:/Users/vishw/OneDrive/Desktop/reactjs nodejs/client/Client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/vishw/OneDrive/Desktop/reactjs nodejs/client/Client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/vishw/OneDrive/Desktop/reactjs nodejs/client/Client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import axios from\"axios\";import{useEffect,useState}from\"react\";import{useParams}from\"react-router-dom\";import{CKEditor}from'@ckeditor/ckeditor5-react';import ClassicEditor from'@ckeditor/ckeditor5-build-classic';import{Alert,Spinner}from'react-bootstrap';import ReactHtmlParser,{processNodes,convertNodeToElement,htmlparser2}from'react-html-parser';// import 'react-input-tags-hooks/build/index.css'; // required\nimport Select from'react-select';import makeAnimated from'react-select/animated';import{options}from'./data';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var animatedComponents=makeAnimated();export default function Updatenewpost(props){var _array$,_array$2;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),title=_useState4[0],setTitle=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),description=_useState6[0],setDescription=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),viewimage=_useState8[0],setViewimage=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),imagedata=_useState10[0],setDImagedata=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),array=_useState12[0],setArray=_useState12[1];var _useState13=useState(''),_useState14=_slicedToArray(_useState13,2),pname=_useState14[0],setPname=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),tags=_useState16[0],setTags=_useState16[1];var optiondefault=tags;console.log(options,\"options\");console.log(optiondefault,\"optiondefault\");var url=\"/showfiles/\"+props.Postid;var fetchlist=function fetchlist(){axios.get(url).then(function(response){setArray(response.data);setTitle(response.data[0].title);setViewimage(\"/\"+response.data[0].file_name);setTags(JSON.parse(response.data[0].tag));console.log(response.data[0],\"psjbkfbk\");});};useEffect(function(){fetchlist();setPname(JSON.parse(localStorage.getItem('user-info')));},[]);var handleChangeckeditor=function handleChangeckeditor(e,editor){var data=editor.getData();setDescription(data);};function handlefile(_x){return _handlefile.apply(this,arguments);}function _handlefile(){_handlefile=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(file){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setDImagedata(file[0]);setViewimage(URL.createObjectURL(file[0]));case 2:case\"end\":return _context.stop();}}},_callee);}));return _handlefile.apply(this,arguments);}var onchangeSelect=function onchangeSelect(item){setTags(item);};function updatearticle(_x2){return _updatearticle.apply(this,arguments);}function _updatearticle(){_updatearticle=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var account,fData,_iterator,_step,pair,url;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();account=pname.email;fData=new FormData();fData.append(\"filename\",imagedata);fData.append(\"title\",title);fData.append(\"description\",description);fData.append(\"account\",account);fData.append(\"tag\",JSON.stringify(tags));_iterator=_createForOfIteratorHelper(fData.entries());try{for(_iterator.s();!(_step=_iterator.n()).done;){pair=_step.value;console.log(pair[0]+', '+pair[1]);}}catch(err){_iterator.e(err);}finally{_iterator.f();}url=\"http://localhost:3001/updatedata/\"+props.Postid;axios.post(url,fData).then(function(res){console.log(res);if(res.data.status==200){setError([\"success\",\"Updated Successfully\",\"border\"]);setTimeout(function(){setError([]);},3000);}});case 12:case\"end\":return _context2.stop();}}},_callee2);}));return _updatearticle.apply(this,arguments);}return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"section\",{className:\"\",children:[/*#__PURE__*/_jsx(\"div\",{className:\" \",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6 \",style:styling.overflowheight,children:[/*#__PURE__*/_jsx(\"label\",{for:\"inputEmail\",className:\"sr-only\",children:\"Title\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",placeholder:\"Enter Title\",defaultValue:(_array$=array[0])===null||_array$===void 0?void 0:_array$.title,onChange:function onChange(e){setTitle(e.target.value);}}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"label\",{for:\"\",className:\"sr-only\",children:\"Description\"}),/*#__PURE__*/_jsx(CKEditor,{editor:ClassicEditor,data:(_array$2=array[0])===null||_array$2===void 0?void 0:_array$2.description,onChange:handleChangeckeditor}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Select,{closeMenuOnSelect:false,components:animatedComponents,defaultValue:tags,isMulti:true,options:options,onChange:onchangeSelect}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"label\",{for:\"uploadfile\",className:\"sr-only\",children:\"Upload File \"}),/*#__PURE__*/_jsx(\"input\",{name:\"file_name\",id:\"filename\",type:\"file\",onChange:function onChange(e){return handlefile(e.target.files);}}),viewimage!=''?/*#__PURE__*/_jsx(\"figure\",{className:\"mb-4\",children:/*#__PURE__*/_jsx(\"img\",{className:\"img-fluid rounded\",src:viewimage,height:\"100\",width:\"100\",alt:\"...\"})}):null,/*#__PURE__*/_jsx(\"label\",{for:\"Tag\",className:\"sr-only\",children:\"Enter Tags \"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-md btn-primary btn-block\",onClick:function onClick(e){if(title==''||description==''||tags==''){setError([\"danger\",\"Fill the fields\"]);setTimeout(function(){setError('');},3000);}else if(imagedata==''){setError([\"danger\",\"Upload the files\"]);setTimeout(function(){setError('');},3000);}else{updatearticle(e);}},children:\"Update Post\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{})]}),/*#__PURE__*/_jsx(\"div\",{className:\"col-md-6 d-flex\",style:styling.overflowheight1,children:title!==''||description!==''||viewimage!==''?/*#__PURE__*/_jsxs(\"article\",{className:\"\",children:[/*#__PURE__*/_jsx(\"header\",{className:\"mb-3 \",children:/*#__PURE__*/_jsx(\"h4\",{className:\"fw-bolder text-break\",children:title})}),/*#__PURE__*/_jsx(\"div\",{class:\"mb-3\",children:tags.map(function(item,i){return/*#__PURE__*/_jsx(\"a\",{className:\"badge bg-secondary mx-1 text-capitalize text-decoration-none link-light\",style:{display:\"inline\"},href:\"/service/search/\"+item.value,children:item.value},i);})}),viewimage!=''?/*#__PURE__*/_jsx(\"figure\",{className:\"mb-4\",children:/*#__PURE__*/_jsx(\"img\",{className:\"img-fluid rounded\",src:viewimage,height:\"300\",alt:\"...\"})}):null,/*#__PURE__*/_jsx(\"section\",{className:\"mb-5 text-break\",children:ReactHtmlParser(description)})]}):/*#__PURE__*/_jsx(\"h2\",{className:\"text-center pb-3 m-auto\",children:\"Preview\"})})]})}),error!=''?/*#__PURE__*/_jsxs(Alert,{variant:error[0],className:\"m-2\",children:[error[1],\" \",/*#__PURE__*/_jsx(Spinner,{animation:error[2],size:\"sm\"})]}):null]})});}var styling={overflowheight:{maxHeight:\"50rem\",overflowX:\"hidden\"},overflowheight1:{maxHeight:\"50rem\",overflowX:\"auto\"}};","map":{"version":3,"sources":["C:/Users/vishw/OneDrive/Desktop/reactjs nodejs/client/client/src/Components/Post/Updatenewpost.js"],"names":["axios","useEffect","useState","useParams","CKEditor","ClassicEditor","Alert","Spinner","ReactHtmlParser","processNodes","convertNodeToElement","htmlparser2","Select","makeAnimated","options","animatedComponents","Updatenewpost","props","error","setError","title","setTitle","description","setDescription","viewimage","setViewimage","imagedata","setDImagedata","array","setArray","pname","setPname","tags","setTags","optiondefault","console","log","url","Postid","fetchlist","get","then","response","data","file_name","JSON","parse","tag","localStorage","getItem","handleChangeckeditor","e","editor","getData","handlefile","file","URL","createObjectURL","onchangeSelect","item","updatearticle","preventDefault","account","email","fData","FormData","append","stringify","entries","pair","post","res","status","setTimeout","styling","overflowheight","target","value","files","overflowheight1","map","i","display","maxHeight","overflowX"],"mappings":"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","sourcesContent":["import axios from \"axios\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport { CKEditor } from '@ckeditor/ckeditor5-react';\r\nimport ClassicEditor from '@ckeditor/ckeditor5-build-classic';\r\nimport { Alert, Spinner } from 'react-bootstrap';\r\nimport ReactHtmlParser, { processNodes, convertNodeToElement, htmlparser2 } from 'react-html-parser';\r\n// import 'react-input-tags-hooks/build/index.css'; // required\r\nimport Select from 'react-select';\r\nimport makeAnimated from 'react-select/animated';\r\nimport {options} from './data';\r\nconst animatedComponents = makeAnimated();\r\n\r\nexport default function Updatenewpost(props) {\r\n    const [error, setError] = useState(\"\");\r\n    const [title, setTitle] = useState(\"\");\r\n    const [description, setDescription] = useState(\"\");\r\n    const [viewimage, setViewimage] = useState(\"\");\r\n    const [imagedata, setDImagedata] = useState(\"\");\r\n    const [array, setArray] = useState([]);\r\n    const [pname, setPname] = useState('');\r\n    const [tags, setTags] = useState([]);\r\n\r\n\r\n    const optiondefault = tags;\r\n\r\n    console.log(options, \"options\")\r\n    console.log(optiondefault, \"optiondefault\")\r\n\r\n    let url = \"/showfiles/\" + props.Postid;\r\n\r\n    const fetchlist = () => {\r\n        axios.get(url).then(response => {\r\n            setArray(response.data)\r\n            setTitle(response.data[0].title);\r\n            setViewimage(\"/\" + response.data[0].file_name);\r\n            setTags(JSON.parse(response.data[0].tag));\r\n            console.log(response.data[0], \"psjbkfbk\")\r\n        })\r\n    }\r\n\r\n    useEffect(() => {\r\n        fetchlist();\r\n        setPname(JSON.parse(localStorage.getItem('user-info')));\r\n    }, [])\r\n\r\n    const handleChangeckeditor = (e, editor) => {\r\n        const data = editor.getData();\r\n        setDescription(data);\r\n    }\r\n    async function handlefile(file) {\r\n        setDImagedata(file[0]);\r\n        setViewimage(URL.createObjectURL(file[0]))\r\n    }\r\n    \r\n    const onchangeSelect = (item) => {\r\n        setTags(item)\r\n    };\r\n\r\n    async function updatearticle(e) {\r\n        e.preventDefault();\r\n        const account = pname.email;\r\n        const fData = new FormData();\r\n        fData.append(\"filename\", imagedata);\r\n        fData.append(\"title\", title);\r\n        fData.append(\"description\", description);\r\n        fData.append(\"account\", account);\r\n        fData.append(\"tag\", JSON.stringify(tags));\r\n        for (var pair of fData.entries()) {\r\n            console.log(pair[0] + ', ' + pair[1]);\r\n        }\r\n        let url = \"http://localhost:3001/updatedata/\" + props.Postid;\r\n        axios.post(url, fData)\r\n            .then((res) => {\r\n                console.log(res);\r\n                if (res.data.status == 200) {\r\n                    setError([\"success\", \"Updated Successfully\", \"border\"]);\r\n                    setTimeout(() => {\r\n                        setError([]);\r\n                    }, 3000);\r\n                }\r\n            });\r\n    }\r\n\r\n\r\n    return (<>\r\n        <section className=\"\">\r\n            <div className=\" \">\r\n                <div className=\"row\" >\r\n                    <div className=\"col-md-6 \" style={styling.overflowheight}>\r\n                        {/* <h1 className=\"h3 mb-3 font-weight-bold text-center\">Update Post</h1> */}\r\n                        <label for=\"inputEmail\" className=\"sr-only\">Title</label>\r\n                        <input type=\"text\" className=\"form-control\" placeholder={\"Enter Title\"} defaultValue={array[0]?.title} onChange={(e) => { setTitle(e.target.value) }} /><br />\r\n                        <label for=\"\" className=\"sr-only\">Description</label>\r\n                        <CKEditor editor={ClassicEditor} data={array[0]?.description} onChange={handleChangeckeditor} />\r\n                        <br />\r\n                        <Select\r\n                            closeMenuOnSelect={false}\r\n                            components={animatedComponents}\r\n                            defaultValue={tags}\r\n                            isMulti\r\n                            options={options}\r\n                            onChange={onchangeSelect}\r\n                        />\r\n                        <br />\r\n                        <label for=\"uploadfile\" className=\"sr-only\">Upload File </label>\r\n                        <input name=\"file_name\" id=\"filename\" type=\"file\" onChange={(e) => handlefile(e.target.files)} />\r\n                        {viewimage != '' ? (\r\n                            <figure className=\"mb-4\"><img className=\"img-fluid rounded\" src={viewimage} height=\"100\" width=\"100\" alt=\"...\" /></figure>\r\n                        ) : null}\r\n\r\n                        <label for=\"Tag\" className=\"sr-only\">Enter Tags </label>\r\n                        <button className=\"btn btn-md btn-primary btn-block\" onClick={(e) => {\r\n                            if (title == '' || description == '' || tags == '') {\r\n                                setError([\"danger\", \"Fill the fields\"]);\r\n                                setTimeout(() => { setError('') }, 3000);\r\n                            } else if (imagedata == '') {\r\n                                setError([\"danger\", \"Upload the files\"]);\r\n                                setTimeout(() => { setError('') }, 3000);\r\n                            }\r\n                            else {\r\n                                updatearticle(e)\r\n                            }\r\n                        }} >Update Post</button>\r\n                        <br /><br />\r\n                    </div>\r\n                    <div className=\"col-md-6 d-flex\" style={styling.overflowheight1}>\r\n                        {title !== '' || description !== '' || viewimage !== '' ? (\r\n                            <article className=\"\" >\r\n                                {/* <h2 className=\"text-center pb-3\">Preview</h2> */}\r\n                                <header className=\"mb-3 \">\r\n                                    <h4 className=\"fw-bolder text-break\">{title}</h4>\r\n                                </header>\r\n                                <div class=\"mb-3\">\r\n                                    {tags.map((item, i) =>\r\n                                        <a key={i} className=\"badge bg-secondary mx-1 text-capitalize text-decoration-none link-light\" style={{ display: \"inline\" }} href={\"/service/search/\" + item.value}>{item.value}</a>\r\n                                    )}\r\n                                </div>\r\n                                {viewimage != '' ? (\r\n                                    <figure className=\"mb-4\"><img className=\"img-fluid rounded\" src={viewimage} height=\"300\" alt=\"...\" /></figure>\r\n                                ) : null}\r\n                                <section className=\"mb-5 text-break\">\r\n                                    {ReactHtmlParser(description)}\r\n                                </section>\r\n                            </article>\r\n                        ) : (\r\n                            <h2 className=\"text-center pb-3 m-auto\">Preview</h2>)\r\n                        }\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            {error != '' ? (<Alert variant={error[0]} className=\"m-2\" >{error[1]} <Spinner animation={error[2]} size=\"sm\" /></Alert>) : null}\r\n        </section>\r\n    </>);\r\n}\r\n\r\nconst styling = {\r\n    overflowheight: {\r\n        maxHeight: \"50rem\",\r\n        overflowX: \"hidden\",\r\n    },\r\n    overflowheight1: {\r\n        maxHeight: \"50rem\",\r\n        overflowX: \"auto\",\r\n    },\r\n\r\n}"]},"metadata":{},"sourceType":"module"}